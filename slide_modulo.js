var scene,camera,renderer,loopFunctions=[],stats,deploy=true;var clock=new THREE.Clock,composer;function removeFromLoop(fx){for(i in loopFunctions)if(loopFunctions[i][1]===fx)loopFunctions.splice(i,1)}function animate(){if(!paused)requestAnimationFrame(animate);var time=Date.now()*5e-5;for(i in loopFunctions)loopFunctions[i][0](time)}function render(time){if(!deploy)stats.update();renderer.clear();renderer.render(scene,camera);var delta=clock.getDelta();composer.render(delta)}function update3DonWindowResize(){if(Mirrors.instance==true){camera.aspect=w/h;camera.updateProjectionMatrix();renderer.setSize(w,h);Mirrors.resize()}}if(!deploy){stats=new Stats;container.appendChild(stats.dom)}var planes=[],uMouse={x:0,y:0},xMouse={x:0,y:0},followMouse={x:0,y:0},prevMouse={x:0,y:0},targetSpeed=0,speed=0,currentPlane=undefined,instance=null,followTimer=null,exitTimer=null;let activeTexture=0;let currentTexture=0;let transitionTimer=0;let initialTransition={value:0};let timer=0;let isRunning=false;let planeElements;let tween;var Effect={instance:false,init:function(){let _this=this;const curtains=new Curtains({container:"canvas",autoRender:true,pixelRatio:Math.min(1.5,window.devicePixelRatio)});instance=curtains;curtains.onRender(()=>{if(currentPlane){if(isRunning==false){targetSpeed=0;initialTransition.value=0}else{getSpeed()}currentPlane.uniforms.transitionTimer.value=Math.min(targetSpeed,.05)*2+initialTransition.value;targetSpeed*=.999;currentPlane.uniforms.xaxis.value=followMouse.x;currentPlane.uniforms.yaxis.value=followMouse.y}}).onScroll(function(){if(currentPlane){currentPlane._size=currentPlane.htmlElement.getBoundingClientRect()}});planeElements=[...document.getElementsByClassName("plane")];const params={visible:false,vertexShader:`
      precision mediump float;

      // default mandatory variables
      attribute vec3 aVertexPosition;
      attribute vec2 aTextureCoord;

      uniform mat4 uMVMatrix;
      uniform mat4 uPMatrix;

      // our texture matrices
      // displacement texture does not need to use them
      uniform mat4 firstTextureMatrix;
      uniform mat4 secondTextureMatrix;

      // custom variables
      varying vec3 vVertexPosition;
      varying vec2 vTextureCoord;
      varying vec2 vFirstTextureCoord;
      varying vec2 vSecondTextureCoord;

      // custom uniforms
      uniform float uTransitionTimer;

      void main() {
          gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);

          // varyings
          // use original texture coords for our displacement
          vTextureCoord = aTextureCoord;
          // use texture matrices for our videos
          vFirstTextureCoord = (firstTextureMatrix * vec4(aTextureCoord, 0.0, 1.0)).xy;
          vSecondTextureCoord = (secondTextureMatrix * vec4(aTextureCoord, 0.0, 1.0)).xy;
          vVertexPosition = aVertexPosition;
      }
      `,fragmentShader:`
      precision mediump float;

      varying vec3 vVertexPosition;
      varying vec2 vTextureCoord;
      varying vec2 vFirstTextureCoord;
      varying vec2 vSecondTextureCoord;

      // custom uniforms
      uniform float uTransitionTimer;
      uniform float uTimer;
      uniform float uTo;
      uniform float uFrom;
      uniform float uFadeIn;
      uniform float uXaxis;
      uniform float uYaxis;
      uniform float u_resolutionX;
      uniform float u_resolutionY;

      // our textures samplers
      uniform sampler2D firstTexture;
      uniform sampler2D secondTexture;
      uniform sampler2D thirdTexture;
      uniform sampler2D displacement;

       vec4 getTextureByIndex(float index, vec2 vUv){
           vec4 result;
           if(index==0.){
               result = texture2D(firstTexture,vUv);
           }
           if(index==1.){
               result = texture2D(secondTexture,vUv);
           }
           if(index==2.){
               result = texture2D(thirdTexture,vUv);
           }
           return result;
       }
       float circle (in vec2 uv, in float radius, in float sharpness) {
          vec2 position = uv - vec2(uXaxis, uYaxis);
          position.x *= u_resolutionX / u_resolutionY;
          return 1.0 - smoothstep(radius-sharpness, radius, length(position));
       }
      void main() {
          float progress = fract(uTransitionTimer);

          vec2 center = vec2(0.5);
          vec2 centerVector = vFirstTextureCoord - center;
          vec2 vUv = (vFirstTextureCoord - vec2(0.5))*(0.2 + 0.8*uFadeIn) + vec2(0.5) + 0.6*vec2(0.,1. - uFadeIn);
          float mask = step(vTextureCoord.y,uFadeIn);


           float circleProgress = circle(vTextureCoord, progress*1.5, 0.6);
           float ease = progress*(2. - progress);
           vec2 nextUV = vUv + centerVector * (circleProgress - 1.0) + centerVector * ( 1. - ease) * .0;
           vec2 currentUV = vUv - centerVector * circleProgress*0.5 - centerVector * progress * .0;

           float currentTexture = mod(uFrom,3.);
           float nextTexture =  mod(uTo, 3.);

           vec4 current = getTextureByIndex(0., currentUV);
           vec4 next = getTextureByIndex(1., nextUV);

           gl_FragColor = mix(vec4(0.,0.,0.,0),mix(current,next,circleProgress), mask);
      }
      `,uniforms:{transitionTimer:{name:"uTransitionTimer",type:"1f",value:0},fadeIn:{name:"uFadeIn",type:"1f",value:1},timer:{name:"uTimer",type:"1f",value:0},to:{name:"uTo",type:"1f",value:0},from:{name:"uFrom",type:"1f",value:0},xaxis:{name:"uXaxis",type:"1f",value:1},yaxis:{name:"uYaxis",type:"1f",value:1},resolutionX:{name:"u_resolutionX",type:"1f",value:window.innerWidth},resolutionY:{name:"u_resolutionY",type:"1f",value:window.innerHeight}}};for(let i=0;i<planeElements.length;i++){const plane=new Plane(curtains,planeElements[i],params);plane._sliderID=planeElements[i].getAttribute("data_slider_id");planes.push(plane);planeElements[i].setAttribute("data-id",i);planeElements[i].addEventListener("mouseenter",_this.onEnter,false);planeElements[i].addEventListener("mouseleave",_this.onLeave,false);handlePlanes(i)}function handlePlanes(index){const plane=planes[index];plane.onReady(()=>{if(index===planes.length-1){document.body.classList.add("planes-loaded")}}).onRender(()=>{})}},onTranslate:function(ID){if(!currentPlane){instance.enableDrawing()}for(var i=0;i<planes.length;++i){if(planes[i]._sliderID==ID)planes[i].updatePosition()}},onTranslateEnd:function(){},updatePlaneTexture:function(ID){},onEnter:function(event){if(event.target.classList.contains("ready")){body.classList.add("curtains");isRunning=false;exitTimer=setTimeout(function(){if(tween)tween.pause();clearTimeout(followTimer);currentPlane=planes[event.target.getAttribute("data-id")];currentPlane._size=event.target.getBoundingClientRect();currentPlane._id=event.target.getAttribute("data-id");isRunning=true;currentPlane.uniforms.resolutionX.value=currentPlane._size.width;currentPlane.uniforms.resolutionY.value=currentPlane._size.height;initialTransition.value=.2;instance.enableDrawing()},111)}},onLeave:function(event){clearTimeout(exitTimer);tween=anime({targets:initialTransition,value:0,easing:"easeInCubic",duration:300});followTimer=setTimeout(function(){targetSpeed=0;currentPlane=undefined;instance.disableDrawing();body.classList.remove("curtains")},300)},onMouseMove:function(){if(currentPlane){uMouse.x=(xMouse.x-currentPlane._size.x)/currentPlane._size.width;uMouse.y=1-(xMouse.y-currentPlane._size.y)/currentPlane._size.height}},destroy:function(){let _this=this;body.classList.remove("curtains");for(var i=0;i<planeElements.length;++i){planeElements[i].setAttribute("data-id","");planeElements[i].removeEventListener("mouseenter",_this.onEnter,false);planeElements[i].removeEventListener("mouseleave",_this.onLeave,false);planeElements.splice(i,1)}planes=[];instance.dispose();instance=null},stop:function(){},play:function(){}};document.addEventListener("mousemove",function(e){xMouse.x=e.clientX;xMouse.y=e.clientY;Effect.onMouseMove();if(Mirrors.instance==true){Mirrors.onMouseMove()}});function getSpeed(){speed=Math.sqrt((prevMouse.x-uMouse.x)**2+(prevMouse.y-uMouse.y)**2);targetSpeed-=.1*(targetSpeed-speed);followMouse.x-=.1*(followMouse.x-uMouse.x);followMouse.y-=.1*(followMouse.y-uMouse.y);prevMouse.x=uMouse.x;prevMouse.y=uMouse.y}var Story={instance:false,data:[],vars:{playPromise:undefined,first:true},init:function(){let t=this,vars=this.vars,data=this.data;vars.current=0;vars.plane=document.querySelector(".story .fiber");vars.video=document.querySelector(".story video");vars.subtitle=document.querySelector(".story .subtitle span.medium");vars.svg=document.querySelector(".story .subtitle svg");vars.progressHolder=document.querySelector(".story .story__progress");vars.progressBar=document.querySelector(".story .story__progress__bar");vars.currentSpan=document.querySelector(".story .story__progress__numbers .current");vars.totalSpan=document.querySelector(".story .story__progress__numbers .total");data.splice(0,data.length);let arr=vars.video.getAttribute("data-story").split("|");for(var i=0;i<arr.length;++i){let item=arr[i].split(",");data.push({caption:item[0],video:item[1]})}vars.totalSpan.textContent=arr.length<10?" / 0"+arr.length:" / "+arr.length;vars.slice=100/data.length;vars.progressHolder.style.cssText="-webkit-mask-size: "+vars.slice+"%";vars.video.addEventListener("ended",function(){Story.next()});vars.video.addEventListener("timeupdate",function(e){Story.onTimeUpdate()});vars.video.onplay=function(){if(vars.on!=true)vars.video.pause()};this.playSubtitle(data[0].caption);this.initEvents();t.instance=true;LoopObjects.push(Story)},initEvents(){let vars=this.vars;vars.plane.addEventListener("mousemove",function(e){if(e.clientX<w*.4){vars.plane.classList.remove("cursor-right");vars.plane.classList.add("cursor-left")}else{vars.plane.classList.remove("cursor-left");vars.plane.classList.add("cursor-right")}});vars.plane.addEventListener("click",function(e){if(e.clientX>w*.4){Story.next()}else{Story.prev()}})},onTimeUpdate:function(){let vars=this.vars;let progress=vars.current*vars.slice+vars.video.currentTime/vars.video.duration*vars.slice;if(!isNaN(progress))vars.progressBar.style.cssText="transform: translateX("+progress+"%)"},prev:function(){let vars=this.vars,data=this.data;if(vars.current>0){vars.current--}else{vars.current=data.length-1}this.playStory()},next:function(){let vars=this.vars,data=this.data;let box=vars.plane.getBoundingClientRect();if(box.top>-h&&box.top<h){if(vars.current<data.length-1){vars.current++}else{vars.current=0}this.playStory()}else{this.pause()}},playStory:function(){let vars=this.vars,data=this.data;let currentDisplayNumber=vars.current+1;vars.currentSpan.textContent=currentDisplayNumber<10?"0"+currentDisplayNumber:currentDisplayNumber;let videoFile=data[vars.current].video;let caption=data[vars.current].caption;this.playSubtitle(caption);if(vars.current!=0){vars.video.setAttribute("src",videoFile)}else{}if(instance){instance.planes[0].textures[0].needUpdate();instance.disableDrawing()}vars.playPromise=vars.video.play();vars.playPromise.then(_=>{if(instance){instance.enableDrawing();instance.needRender()}}).catch(error=>{})},playSubtitle:function(caption){let vars=this.vars;vars.subtitle.innerHTML="<span class='letter'>"+caption.replaceAll(" ","</span> <span class='letter'>")+"</span>";let s=0;M99.animate({element:vars.subtitle,type:"subtitle"},null,function(e){s+=e;vars.svg.style.cssText="transform: translateX("+s+"px)"})},play:function(){let vars=this.vars;if(vars.on==true){vars.video.loop=false;vars.playPromise=vars.video.play();if(instance){instance.enableDrawing();instance.needRender()}}},pause:function(){let vars=this.vars;if(vars.playPromise!==undefined){vars.playPromise.then(_=>{vars.video.pause()}).catch(error=>{})}},destroy:function(){let t=this,vars=this.vars;if(vars.playPromise!==undefined){vars.playPromise.then(_=>{vars.video.pause()}).catch(error=>{})}t.instance=false}};var blobVideo,blobPlayPromise,stone,distortion={base:80,noise:65},k=1.5,time=0;const Blob={instance:false,init:function(obj){let t=this;t.initScene(obj.element);setTimeout(function(){t.initGraphics()},111);t.instance=true;LoopObjects.push(Blob)},initScene:function(element){let container=element;let fieldOfView=55,nearPlane=1,farPlane=1e3,aspectRatio=1;camera=new THREE.PerspectiveCamera(fieldOfView,aspectRatio,nearPlane,farPlane);camera.position.set(0,0,245);scene=new THREE.Scene;renderer=new THREE.WebGLRenderer({alpha:true});renderer.setPixelRatio(window.devicePixelRatio);renderer.setSize(1e3,1e3);renderer.shadowMap.enabled=true;renderer.autoClear=false;renderer.setClearColor(0,0);container.innerHTML="";container.appendChild(renderer.domElement);var controls=new THREE.OrbitControls(camera,renderer.domElement);controls.target.set(0,0,0);controls.enableZoom=false;controls.enablePan=false;controls.update();var renderPass=new THREE.RenderPass(scene,camera);var rgbShift=new THREE.ShaderPass(THREE.RGBShiftShader);rgbShift.uniforms.amount.value=.003;composer=new THREE.EffectComposer(renderer);composer.addPass(renderPass);composer.addPass(rgbShift);loopFunctions.push([render,"RENDER_BLOB"])},initGraphics:function(){let t=this;var obj=new THREE.Object3D;var geometry=new THREE.BoxGeometry(1.6,.9,1.6,3,3,3);var mesh=new THREE.Mesh(geometry,new THREE.MeshStandardMaterial({color:16711680,side:THREE.DoubleSide,wireframe:false}));stone=mesh;obj.add(mesh);scene.add(obj);t.castVideo();loopFunctions.push([updateVertices,"UPDATE_VERTICES"]);animate()},castVideo:function(){blobVideo=document.createElement("video");blobVideo.src="https://www.minus99.com/src/temp/career.mp4";blobVideo.muted=!0;blobVideo.loop=!0;blobVideo.currentTime=1;blobVideo.lastFrame=!1;blobVideo.preload=!0;blobPlayPromise=blobVideo.play();if(blobPlayPromise!==undefined){blobPlayPromise.then(function(){var texture=new THREE.VideoTexture(blobVideo);texture.crossOrigin="Anonymous";texture.minFilter=THREE.LinearFilter;texture.magFilter=THREE.LinearFilter;texture.format=THREE.RGBFormat;texture.needsUpdate=true;stone.material=new THREE.MeshBasicMaterial({color:16775131,map:texture,side:THREE.DoubleSide})}).catch(function(error){console.log("video could not play!")})}},pause:function(){if(blobPlayPromise!==undefined){blobPlayPromise.then(function(){blobVideo.pause()}).catch(function(error){})}},play:function(){blobPlayPromise=blobVideo.play();animate()},destroy:function(){let t=this;removeFromLoop("RENDER_BLOB");removeFromLoop("UPDATE_VERTICES");time=0;t.instance=false;stone.material.dispose()}};function updateVertices(){stone.rotation.y+=.002;stone.rotation.x+=.001;stone.rotation.z+=.003;if(stone){time+=.005;for(var i=0;i<stone.geometry.vertices.length;i++){var p=stone.geometry.vertices[i];p.normalize().multiplyScalar(distortion.base+distortion.noise*noise.perlin3(p.x*k+time,p.y*k,p.z*k))}stone.geometry.computeVertexNormals();stone.geometry.normalsNeedUpdate=true;stone.geometry.verticesNeedUpdate=true}}let grid={width:40,height:20,x:80,y:40};let objRotationBase={x:10,y:0,z:20,z_shift:0,zoom:0,dist:0};mirrorsTime=0;let gridMouse={x:0,y:0},pos=new THREE.Vector3,vec=new THREE.Vector3,vecs=[],bits,line,obj;const Mirrors={instance:false,isPaused:false,init:function(obj){let t=this;t.initScene(obj.element);setTimeout(function(){t.initGraphics()},111);t.instance=true;LoopObjects.push(Mirrors)},initScene:function(element){let container=element;scene=new THREE.Scene;scene.fog=new THREE.FogExp2(16777215,.024);camera=new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,1e3);camera.lookAt(0,0,0);renderer=new THREE.WebGLRenderer({antialias:true,alpha:true});renderer.setSize(window.innerWidth,window.innerHeight);renderer.setClearColor(6710886,0);container.appendChild(renderer.domElement);var renderPass=new THREE.RenderPass(scene,camera);var rgbShift=new THREE.ShaderPass(THREE.RGBShiftShader);rgbShift.uniforms.amount.value=.0015;rgbShift.uniforms.tDiffuse.value=1;rgbShift.uniforms.angle.value=.5;composer=new THREE.EffectComposer(renderer);composer.addPass(renderPass);composer.addPass(rgbShift);loopFunctions.push([render,"RENDER"])},initGraphics:function(){let t=this;obj=new THREE.Object3D;const geometry=createGeometry();const material=new THREE.LineBasicMaterial({color:0,opacity:1});line=new THREE.LineSegments(geometry,material);line.updateMatrix();vecs=line.geometry.attributes.position.array;obj.add(line);scene.add(obj);t.addImage();loopFunctions.push([t.animateScene,"ANIMATE_SCENE"]);t.resize();t.introAnimation();t.animateScene();animate()},introAnimation:function(){anime({targets:objRotationBase,z_shift:1e3,zoom:20,x:[-10,8],z:[50,20],easing:"easeInExpo",duration:5555});anime({targets:obj.rotation,y:[0,360*THREE.Math.DEG2RAD],easing:"easeInOutCubic",duration:2222,delay:3333,complete:function(){scrollTip.style.cssText="opacity:1"}})},animateScene:function(time){let r=0;updateDots();for(var i=0;i<vecs.length;i+=6){vec.set(vecs[i],vecs[i+1],vecs[i+2]);angle=Math.atan2(pos.x-vec.x,pos.y-vec.y);rad=Math.min(1,vec.distanceTo(pos)*.03);vecs[i+3]=vecs[i]+Math.sin(angle)*rad;vecs[i+4]=vecs[i+1]+Math.cos(angle)*rad;vecs[i+2]-=rad*objRotationBase.zoom;vecs[i+5]-=rad*objRotationBase.zoom}line.updateMatrix();line.geometry.attributes.position.needsUpdate=true;destX=-(xMouse.x-w*.5)*.01+objRotationBase.x;destY=(xMouse.y-h*.5)*.02+objRotationBase.y;destZ=(xMouse.y-h*.5)*.02+objRotationBase.z;vecX=destX-camera.position.x;vecY=destY-camera.position.y;vecZ=destZ-camera.position.z;camera.position.x+=vecX/30;camera.position.y+=vecY/30;camera.position.z+=vecZ/30;camera.lookAt(0,0,0)},onMouseMove:function(){gridMouse.x=xMouse.x/w*2-1;gridMouse.y=-(xMouse.y/h)*2+1;var vector=new THREE.Vector3(gridMouse.x,gridMouse.y,.5);vector.unproject(camera);var dir=vector.sub(camera.position).normalize();var distance=-camera.position.z/dir.z;pos=camera.position.clone().add(dir.multiplyScalar(distance))},pause:function(){removeFromLoop("ANIMATE_SCENE");removeFromLoop("RENDER")},play:function(){let t=this;if(!t.isPaused){mirrorsTime=0;loopFunctions.push([render,"RENDER"]);loopFunctions.push([t.animateScene,"ANIMATE_SCENE"]);animate()}},resize:function(){if(isMobile){camera.fov=70;camera.updateProjectionMatrix();obj.position.y=8}else{camera.fov=40;camera.updateProjectionMatrix();obj.position.y=0}},destroy:function(){let t=this;removeFromLoop("ANIMATE_SCENE");removeFromLoop("RENDER");mirrorsTime=0;t.instance=false;vecs=[];bits=null;objRotationBase={x:10,y:0,z:20,z_shift:0,zoom:0,dist:0}},addImage:function(callback){var canvas=document.createElement("canvas");canvas.id="image";canvas.width=80;canvas.height=40;context=canvas.getContext("2d");var image=new Image;image.onload=function(){context.save();context.translate(0,canvas.height);context.scale(1,-1);context.drawImage(image,0,0,image.width,image.height,0,0,canvas.width,canvas.height);context.restore();bits=context.getImageData(0,0,canvas.width,canvas.height);if(callback)callback()};image.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAoCAYAAABpYH0BAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAALASURBVHgB7ZnRsSlBEIbbvffBGyEQASEQAR49kQEiQASIABEgAjJABIgAb972zu/Uqj27bc2Y7T3q1HxVXceZ3W3V/0739IwMEXnkeJs/5LDCCWiJE9ASJ6AlTkBLnICWOAEtcQJakqqAlUqFptMpHQ4H8jzvYefzmbbb7f1auVzW8rNer+/Phf1gfDweU6FQoLTw0rBOp+PpMhqNnvpRImv76ff7acQmL56aMZ4pECrsB4KY0u12peOTF1ClJxucSuXY4CG870Ol5NP74EelL3sN4/l8XjI+WfG4wBEwxoP3cAIsl8vHPe12W8sP91IkZ6H4IsItCoPBgI7H4+N/fJ7P55H7SqXS43OtVotcX61WET+TySTWT9L8iICn0ykydrlcKA6VhpExrLimfpJGXEDu7QdnTRxB0bgXcb1e6acRF5CbObo9WvBZGz+SPeE/EoZLVzTMaHb3+z3tdjuttMOsDQuh2hrK5XJGfpLGSEAEgFTCbAgGgx0A0glBhgPZbDbUarUifiBg8J5XYMFQzXisH3y3bnlIEu0lW5fFYvHtOVXsvXehFy2KDvh+kzgNLXkBEWj4WfRx7whAoZ5yNpsZ+5EUMOOrqMNXPK9BGhWLRfYaSoBvWKH9kvCMTCbDjuNAAc/jr19anoESUa1WSQpttTGLkJ54o9z2CWPYtsUdBnCmgvdUc83OHpNtGPxw5eJjUljaOIJbNR2r1+upCvjxB6qmq+qv24noEm5RgKkYqKWcH+kdiydtqGOonXHHThzB0xgYjrfe8aP6UMn45AWMO8uLA4tC0A93pPWK8JFX0vaxNXA4HN53FjagBDQaDdHdyV9lAxIGgfh74tvtdjeu90OgKm2p1+uRaphZP7gnm83eP8f5wblgs9kU39oZNdKOKO53YUucgJY4AS1xAlriBLTECWiJE9ASJ6Al/wGqmgNA24+X7wAAAABJRU5ErkJggg=="}};function map(val,smin,smax,emin,emax){const t=(val-smin)/(smax-smin);return(emax-emin)*t+emin}function updateDots(){if(line){mirrorsTime+=.006;let k=0;let v=0;let scale=20;let r=0;for(var i=0;i<vecs.length;i+=6){if(i!=0&&i%grid.x==0){v++,k=0}let s=0;if(bits){s=map(bits.data[r],0,255,0,objRotationBase.z_shift)}vecs[i+2]=noise.perlin3(k/scale+mirrorsTime,v/scale,0)*5+s+objRotationBase.dist;vecs[i+5]=noise.perlin3(k/scale+mirrorsTime,v/scale,0)*5+s+objRotationBase.dist;if(i%2==0)r+=8;k++}}}function createGeometry(){const geometry=new THREE.BufferGeometry;const vertices=[];const vertex=new THREE.Vector3;let v=0;let segx=grid.width/grid.x;let segy=grid.height/grid.y;let start_x=grid.width*.5;let start_y=grid.height*.5;for(let i=0;i<grid.x*grid.y;++i){if(i!=0&&i%grid.x==0)v++;vertex.x=segx*(i-v*grid.x)-start_x+v%2*segx;vertex.y=segy*v-start_y;vertex.z=0;vertices.push(vertex.x,vertex.y,vertex.z)}geometry.setAttribute("position",new THREE.Float32BufferAttribute(vertices,3));return geometry}const Contact={instance:false,vars:{current:0,canClick:true,k:100/6},init:function(){let t=this,vars=this.vars;let obj=document.querySelector(".contact");vars.obj=obj;vars.inner=obj.querySelector(".contact__inner");vars.li=obj.querySelectorAll("ul.radio li label");for(var i=0;i<vars.li.length;++i){vars.li[i].addEventListener("click",t.select,false)}if(t.instance==false){t.validate()}vars.current=0;t.instance=true;setTimeout(function(){t.select()},1500)},select:function(event){let t=Contact,vars=t.vars;vars.current++;vars.inner.style.cssText="transform: translateY(-"+vars.k*vars.current+"%)";vars.obj.setAttribute("class","contact group-"+vars.current)},back:function(event){let t=Contact,vars=t.vars;vars.canClick=false;vars.current--;vars.inner.style.cssText="transform: translateY(-"+vars.k*vars.current+"%)";vars.obj.setAttribute("class","contact group-"+vars.current);setTimeout(function(){vars.canClick=true},1200)},open:function(){let t=this;body.classList.add("contact-open");setTimeout(function(){t.init()},600);dispatchGTagEvent("event",{event:"CONTACT_OPEN",params:{event_category:"Engagement"}})},close:function(){let t=Contact,vars=t.vars;setTimeout(function(){vars.current=0;vars.inner.style.cssText="transform: translateY(0)";vars.obj.setAttribute("class","contact group-0");let checked=vars.obj.querySelectorAll('input[type="radio"]:checked');for(var i=0;i<checked.length;++i){checked[i].checked=false}let ons=vars.obj.querySelectorAll(".on");for(var j=0;j<ons.length;++j){ons[j].classList.remove("on")}let freezes=vars.obj.querySelectorAll(".freeze");for(var k=0;k<freezes.length;++k){freezes[k].classList.remove("freeze")}},555);body.classList.remove("contact-open");dispatchGTagEvent("event",{event:"CONTACT_CLOSE",params:{event_category:"Engagement",value:vars.current}})},validate:function(){let t=Contact,vars=t.vars;var form=new window.JustValidate("#connect",{rules:{fullname:{required:true,name:true,minLength:3,maxLength:35},phone:{required:false,number:true},email:{required:true,email:true},company:{required:true,name:true,minLength:3,maxLength:45}},messages:{fullname:"We would like to know your name",email:"Please enter a valid email so we can reach you",phone:"Are you sure this phone number is corect?",company:"We work with brands big and small, what is your brand?"},submitHandler:function(form,values,ajax){let successMessage=vars.obj.querySelector(".success");let errorMessage=vars.obj.querySelector(".error");values.m99=true;ajax({url:"/src/fx/mail.php",method:"POST",data:values,async:true,callback:function(response){let answer=JSON.parse(response);if(answer.result=="OK"){successMessage.classList.remove("hide");errorMessage.classList.add("hide");t.select()}else{successMessage.classList.add("hide");errorMessage.classList.remove("hide");t.select()}}})}})}};const body=document.body;let w,h,d,s,os,f=null;let menuButton=document.querySelector(".menu");let menuBackgroundAnim=document.querySelector("#menubg animate");let extraButton=document.querySelector(".extra");let logoHolder=document.querySelector(".logo");let logo=document.querySelector(".logo svg");let scrollTip;let project_continue,project_continue_progress,can_continue=true;let sections,sectionFocus,pageProgress,scrollIndicator,indicator_height;let scrollTimer=null;let reelVideo,reelAnime;let preloadAnime;let videos_list=false;let logoResizeTimer=null;let canvas=document.querySelector("#canvas");let container=document.querySelector("#container");let historyState={page_id:0,user_id:Element.id};var _from="M0 0 L800 0 L700 150 L600 300 L0 300 L1200 300 L1100 450 L1000 600 L0 600 L1600 600 L1500 750 L1400 900 L0 900 Z",_to="M0 0 L1600 0 L1600 300 L1400 300 L0 300 L1600 300 L1600 600 L1500 600 L0 600 L1600 600 L1600 900 L1600 900 L0 900 Z";let extraNotOpen=true;let LoopObjects=[];let paused=false,isMobile=false;var M99={init:function(){var t=this;window.addEventListener("resize",t.resize,false);window.addEventListener("scroll",t.scroll,false);window.addEventListener("blur",t.pause,false);window.addEventListener("focus",t.play,false);window.onpopstate=function(event){M99.open({url:event.target.document.URL,push:false})};t.resize();t.menu();t.activate(body);t.scroll();console.log("%c-99 design studio ðŸ˜Ž","background:#FCFF00; color:#000; padding:3px 7px")},menu:function(){menuButton.addEventListener("click",function(){let isMenuOpen=body.classList.contains("menu-open");let menuAction=!isMenuOpen?"_OPEN":"_CLOSE";dispatchGTagEvent("event",{event:"MENU"+menuAction,params:{event_category:"Engagement"}});if(!isMenuOpen)openMenu("menu");else closeMenu("menu")},false);extraButton.addEventListener("click",function(){let isExtraOpen=body.classList.contains("extra-open");let extraAction=!isExtraOpen?"_OPEN":"_CLOSE";dispatchGTagEvent("event",{event:"EXTRA"+extraAction,params:{event_category:"Engagement"}});if(!isExtraOpen)openMenu("extra");else closeMenu("extra")},false);extraButton.addEventListener("mouseenter",function(){if(extraNotOpen){extraNotOpen=false;let imgs=document.querySelectorAll(".special__holder img.lazy");for(var i=0;i<imgs.length;++i){let img=imgs[i];img.setAttribute("src",img.getAttribute("data-src"));img.classList.remove("lazy")}}},false)},scroll:async function(){s=window.scrollY;if(!isMobile){body.classList.remove("curtains");if(scrollTimer!==null){clearTimeout(scrollTimer)}scrollTimer=setTimeout(function(){if(currentPlane!=undefined)body.classList.add("curtains");os=s;if(instance){instance.updateScrollValues(0,s);instance.needRender()}},150);let p=s/(d-h);scrollIndicator.style.cssText="transform: translateY("+p*(h-indicator_height-40)+"px); height:"+indicator_height+"px";if(body.classList.contains("studio")){M99.onScrollLogoHandler()}if(body.classList.contains("post-projects")){M99.onScrollProjectsHandler()}}if(body.classList.contains("home")){M99.onScrollMirrorsHandler()}for(var i=0;i<sections.length;++i){let box=sections[i].getBoundingClientRect();if(box.top<=30&&box.bottom>30&&f!=i){f=i;M99.initSectionFocus(i)}else{}}if(videos_list!=false){for(var j=0;j<videos_list.length;++j){let videoBox=videos_list[j].getBoundingClientRect();if(videoBox.top<=h-100&&videoBox.bottom>100){M99.activateVideo(videos_list[j])}else{M99.deactivateVideo(videos_list[j])}}}},onScrollProjectsHandler:function(){if(project_continue){let rect=project_continue.getBoundingClientRect();if(rect.top<h&&rect.top>0){let p=(1-rect.top/h)*100;project_continue_progress.style.cssText="transform: translateX("+p+"%)"}else if(rect.top<=0&&s>h&&body.classList.contains("done")==true){if(can_continue){project_continue.classList.add("loading");M99.justOpen({url:project_continue.getAttribute("data-url"),push:false})}}}},onScrollLogoHandler:function(){if(s>350){if(logoResizeTimer==null){logo.classList.remove("on");logo.style.cssText="width:130px; height:52px;";logoHolder.style.cssText="position:fixed;";logoResizeTimer=setTimeout(function(){logo.classList.add("on")},333)}}else{clearTimeout(logoResizeTimer);logoResizeTimer=null;logo.style.cssText="";logoHolder.style.cssText="";logo.classList.add("on")}},onScrollMirrorsHandler:function(){if(Mirrors.instance){q=isMobile?100:h*.8;if(s>q){if(!Mirrors.isPaused){Mirrors.isPaused=true;paused=true;setTimeout(function(){paused=false},11);Mirrors.pause();scrollTip.classList.add("hide");if(!instance)Effect.init()}}else{if(Mirrors.isPaused){Mirrors.isPaused=false;Mirrors.play();scrollTip.classList.remove("hide")}}}},initSectionFocus:function(focus){let caption=sections[focus].querySelector(".caption");let width=Math.ceil(caption.getBoundingClientRect().width);pageProgress.style.transform="translateX("+(110+width)+"px)";pageProgress.style.opacity=1;sectionFocus.style.cssText="transform: translateY(-"+focus*13+"px)";let theme=caption.getAttribute("data-theme");if(theme!=null){if(theme=="dark")body.classList.add("dark");else if(theme=="light")body.classList.remove("dark")}},resize:function(){w=window.innerWidth;h=window.innerHeight;d=document.body.clientHeight;isMobile=window.mobile();update3DonWindowResize()},activate:function(ID){let a=0;for(i in this.actions){this.actions[i](ID);a++;if(a==Object.values(this.actions).length){body.classList.add("done");body.classList.remove("hold")}}},actions:{logo:function(){setTimeout(function(){logo.classList.add("on")},1e3)},links:function(ID){const links=ID.querySelectorAll("a");for(var i=0;i<links.length;++i){let link=links[i];if(link.getAttribute("target")!="blank"&&link.getAttribute("target")!="_blank"&&link.getAttribute("href").indexOf("#")<0&&link.getAttribute("href").indexOf("mailto:")<0&&link.getAttribute("href").indexOf("tel:")<0&&link.getAttribute("href").indexOf("javascript:")<0)link.addEventListener("click",function(event){event.preventDefault();var currentPath=window.location.href.split("?")[0];var uri=link.getAttribute("href");if(uri!=currentPath){M99.open({url:uri})}else{if(body.classList.contains("menu-open"))closeMenu("menu")}},false)}},reelPreview:function(ID){let reelPreview=ID.querySelector("#reelPreview");if(reelPreview){reelPreview.play()}},videoPlayer:function(ID){let videos=ID.querySelectorAll("#player");for(var i=0;i<videos.length;++i){let vid=videos[i];let auto=vid.getAttribute("data-auto")=="true"?true:false;if(vid.getAttribute("data-type")=="reel"){reelVideo=vid}const player=new Plyr(vid,{controls:["play","progress","current-time","volume","fullscreen"],iconUrl:"/src/app/m99/assets/icons.svg",autoplay:auto})}},checkProjectPage:function(ID){if(body.classList.contains("post-projects")){project_continue=ID.querySelector(".continue");project_continue_progress=ID.querySelector(".continue .progress")}},checkVideosList:function(ID){let videosList=ID.querySelector(".videos_list");if(videosList){videos_list=ID.querySelectorAll(".videos_list video")}else{videos_list=false}},blob:function(ID){let blob=ID.querySelector("#blob");if(blob){setTimeout(function(){Blob.init({element:blob})},111)}},pageProgress:function(ID){scrollIndicator=document.querySelector(".scroll-indicator");indicator_height=Math.max(100,Math.min(360,h/d*h));pageProgress=document.querySelector(".page-progress");sectionFocus=document.querySelector(".page-progress .focus");const total=document.querySelector(".page-progress .total");sections=document.querySelectorAll("section");let len=sections.length;if(sections.length>1){pageProgress.classList.remove("hide");total.innerHTML=" / "+(len<10?"0"+len:len);let focusHtml="";for(var i=0;i<len;++i){focusHtml+="<em>0"+(i+1)+"</em>"}sectionFocus.innerHTML=focusHtml}else{pageProgress.classList.add("hide")}},buttons:function(ID){const buttons=ID.querySelectorAll(".btn");for(var i=0;i<buttons.length;++i){let btn=buttons[i];if(btn.getAttribute("data-target")!=null){btn.addEventListener("click",function(e){let elem=document.getElementById(btn.getAttribute("data-target"));elem.classList.remove("hide");btn.classList.add("hide");M99.resize();M99.scroll();dispatchGTagEvent("event",{event:"EXPAND",params:{event_category:"Engagement",value:btn.getAttribute("data-target")}})},false)}}},sliders:function(ID){const wraps=ID.querySelectorAll(".slider");for(var i=0;i<wraps.length;++i){const wrap=wraps[i];const viewPort=wrap.querySelector(".slider__viewport");const progressBar=wrap.querySelector(".slider__progress__bar");const slider_inner=wrap.querySelectorAll(".slide__inner");const currentSpan=wrap.querySelector(".slider__progress__numbers .current");const drag=wrap.getAttribute("data-drag")=="snap"?false:true;const embla=EmblaCarousel(viewPort,{containScroll:"trimSnaps",dragFree:drag,loop:!drag});embla._sliderID=i;let inners=wrap.querySelectorAll(".slide__inner");for(var j=0;j<inners.length;++j)inners[j].setAttribute("data_slider_id",i);if(!drag){embla.on("settle",function(e){let current=embla.slidesInView()[0]+1;currentSpan.textContent=current<10?"0"+current:current});for(var j=0;j<slider_inner.length;++j){slider_inner[j].addEventListener("click",function(){embla.scrollNext()})}}embla.on("scroll",function(){let marginsTotal=isMobile?60:200;const progress=Math.max(0,Math.min(1,embla.scrollProgress()));progressBar.style.transform=`translateX(${progress*(w*.75-marginsTotal)}px)`;if(instance)Effect.onTranslate(embla._sliderID)}).on("resize",function(){if(instance)Effect.onTranslate(embla._sliderID)}).on("settle",function(){})}},story:function(ID){let story=ID.querySelector("#story");if(story){Story.init()}},textAnimationPrepare:function(ID){var textWrappers=ID.querySelectorAll(".anim-text, .anim-text-box p");for(var i=0;i<textWrappers.length;++i){let textWrapper=textWrappers[i];if(!textWrapper.classList.contains("ready"))textWrapper.innerHTML="<span class='letter'>"+textWrapper.textContent.replaceAll(" ","</span> <span class='letter'>")+"</span>"}},curtains:function(ID){if(!isMobile&&!body.classList.contains("home"))Effect.init()},page404:function(ID){let deadend=ID.querySelector(".deadend");if(deadend){const strings=document.querySelectorAll(".deadend path");const ball=document.querySelectorAll(".deadend__inner");preloadAnime=anime.timeline({loop:true}).add({targets:strings,d:(el,i)=>{k=i*40+130;t=i*40+100;return"M 0 "+k+" Q 300 "+(k+t)+" 600 "+k},easing:"easeOutExpo",duration:1e3,delay:1400}).add({targets:strings,d:(el,i)=>{k=i*40+130;return"M 0 "+k+" Q 300 "+k+" 600 "+k},easing:"easeOutElastic(3, .2)",duration:1500});anime.timeline({loop:true}).add({targets:ball,translateY:[0,50],easing:"easeOutExpo",duration:1e3,delay:1400}).add({targets:ball,translateY:-700,easing:"easeOutCirc",duration:500}).add({targets:ball,translateY:0,easing:"easeOutBounce",duration:1e3})}},observe:function(ID){let options={root:null,rootMargin:"0px",threshold:.15};let callback=function(entries,observer){for(j in entries){if(entries[j].intersectionRatio>0){var elm=entries[j].target;if(!elm.classList.contains("on")){if(elm.classList.contains("anim-text")){elm.classList.add("on");M99.animate({element:elm,type:"text"})}if(elm.classList.contains("anim-box")){elm.classList.add("on");M99.animate({element:elm,type:"box"})}else if(elm.classList.contains("anim-text-box")){elm.classList.add("on");M99.animate({element:elm,type:"text-box"})}else if(elm.classList.contains("anim-list")){elm.classList.add("on");M99.animate({element:elm,type:"list"})}else if(elm.classList.contains("anim-video")){M99.activateVideo(elm)}}if(elm.classList.contains("lazy")){elm.setAttribute("srcset",elm.getAttribute("data-set"));elm.classList.remove("lazy");let parent_plane=elm.closest(".plane");if(parent_plane!=null&&!isMobile&&instance){let j=parseInt(parent_plane.getAttribute("data-id"));let plane=planes[j];let planeElement=planeElements[j];const loader=new TextureLoader(instance);const image=new Image;image.crossOrigin="anonymous";image.src=elm.getAttribute("data-src");let newTexture;loader.loadImage(image,{sampler:"firstTexture"},texture=>{newTexture=texture;setTimeout(function(){plane.addTexture(newTexture);plane.visible=true;planeElement.classList.add("ready");instance.render();let box=planeElement.getBoundingClientRect();if(uMouse.x>box.x&&uMouse.x<box.right&&uMouse.y>box.y&&uMouse.y<box.bottom)planeElement.dispatchEvent(new Event("mouseenter"))},600)},(image,error)=>{})}}if(elm.classList.contains("infinite-loader")){M99.InfiniteLoad(elm)}if(elm.classList.contains("story")){Story.vars.on=true;Story.play()}}}};let observer=new IntersectionObserver(callback,options);let target=ID.querySelectorAll(".off, img.lazy, .infinite-loader, .story");for(var i=0;i<target.length;++i){observer.observe(target[i])}},mirrors:function(ID){let mirrors=ID.querySelector("#mirrors");if(mirrors){setTimeout(function(){Mirrors.init({element:mirrors})},1111)}scrollTip=document.querySelector(".scrollTip")}},InfiniteLoad:function(obj){let pagination=obj.getAttribute("data-pagination").split("|"),total=pagination[0],current=pagination[1],count=pagination[2];if(total>current*count){obj.classList.add("on");current++;obj.setAttribute("data-pagination",total+"|"+current+"|"+count);let list=document.querySelector("ul.list");let new_url=window.location.href.split("?")[0]+"/page/"+current;M99.animate({element:obj,type:"text"});M99.load(new_url,function(data){obj.classList.remove("on");var html=document.createElement("html");html.innerHTML=data;var page=html.querySelector("ul.list");list.innerHTML+=page.innerHTML;M99.animate({element:list,type:"list"},function(){M99.resize();M99.activate(list)})},function(error){body.classList.remove("preload-on");body.classList.remove("preload-off");console.log(error)})}else{obj.classList.remove("on")}},activateVideo:function(obj){let video=obj;if(!video.classList.contains("on")){video.classList.add("on");let playPromise=video.play();if(playPromise!==undefined){playPromise.then(function(){video.setAttribute("data-playpromise","true")}).catch(function(error){console.log("video could not play!")})}}},deactivateVideo:function(obj){let video=obj;if(video.classList.contains("on")){let promise=video.getAttribute("data-playpromise");if(promise=="true"){video.pause();video.setAttribute("data-playpromise","false");video.classList.remove("on")}}},animate:function(obj,callback,onupdate){switch(obj.type){case"text":{let letters=obj.element.querySelectorAll(".letter");anime.timeline({loop:false}).add({targets:letters,translateY:[40,0],opacity:[0,1],easing:"easeOutExpo",duration:1400,delay:(el,i)=>66*i,complete:function(){if(callback)callback()}})}break;case"box":{anime.timeline({loop:false}).add({targets:obj.element,translateY:[40,0],opacity:[0,1],easing:"easeOutExpo",duration:1400,delay:(el,i)=>66*i,complete:function(){if(callback)callback()}})}break;case"subtitle":{let j=null;anime.timeline({loop:false}).add({targets:obj.element.querySelectorAll(".letter"),translateY:[40,0],opacity:[0,1],easing:"easeOutExpo",duration:1400,delay:function(el,i){if(i!=j){j=i;if(onupdate)setTimeout(function(){onupdate(el.getBoundingClientRect().width+8)},i*250)}return 250*i},complete:function(){if(callback)callback()}})}break;case"text-box":{let letters=obj.element.querySelectorAll(".letter, a.btn");anime.timeline({loop:false}).add({targets:letters,translateY:[40,0],opacity:[0,1],easing:"easeOutExpo",duration:1400,delay:(el,i)=>66*i,complete:function(){if(callback)callback()}})}break;case"list":{const __li=obj.element.querySelectorAll("li:not(.freeze)");anime.timeline({loop:false}).add({targets:__li,translateY:[40,0],opacity:[0,1],easing:"easeOutExpo",duration:1400,delay:(el,i)=>99*i,complete:function(){for(var i=0;i<__li.length;++i){__li[i].classList.add("freeze")}if(callback)callback()}})}break}},openReel:function(e){body.classList.add("reel-open");let reelHolder=document.querySelector(".reel__holder");reelHolder.classList.add("visible");let mask={radius:0};let _x=Math.round(e.clientX/w*100);let _y=Math.round(e.clientY/h*100);reelAnime=anime({targets:mask,radius:130,duration:1500,easing:"easeInOutExpo",update:function(){reelHolder.style.cssText="clip-path: circle("+mask.radius+"% at "+_x+"% "+_y+"%)"},complete:function(){reelVideo._x=_x;reelVideo._y=_y;reelVideo.play()}});dispatchGTagEvent("event",{event:"REEL_OPEN",params:{event_category:"Engagement"}})},closeReel:function(e){reelVideo.pause();body.classList.remove("reel-open");let reelHolder=document.querySelector(".reel__holder");let mask={radius:150};let _x=reelVideo._x;let _y=reelVideo._y;reelAnime=anime({targets:mask,radius:0,delay:500,duration:1500,easing:"easeOutExpo",update:function(){reelHolder.style.cssText="clip-path: circle("+mask.radius+"% at "+_x+"% "+_y+"%)"},complete:function(){reelHolder.classList.remove("visible")}});dispatchGTagEvent("event",{event:"REEL_CLOSE",params:{event_category:"Engagement"}})},mailto:function(){dispatchGTagEvent("event",{event:"MAILTO",params:{event_category:"Engagement"}})},justOpen:function(target){can_continue=false;M99.load(target.url,function(data){var html=document.createElement("html");html.innerHTML=data;var page=html.querySelector("main#content");let new_body=html.querySelector("body");let new_title=html.querySelector("title").innerText;body.setAttribute("class",new_body.getAttribute("class"));document.title=new_title;container.innerHTML='<main id="content">'+page.innerHTML+"</main>";historyState.page_id++;history.pushState(historyState,new_title,target.url);let __path=target.url.split(document.domain)[1].slice(1);dispatchGTagEvent("page",{page_path:__path,page_title:new_title});window.scrollTo(0,0);M99.destroy();setTimeout(function(){M99.resize();M99.activate(container);can_continue=true},1e3)},function(error){console.log(error)})},open:function(target){if(body.classList.contains("menu-open"))closeMenu("menu");const strings=document.querySelectorAll(".tension path");body.classList.add("preload-on");let preloadAnimeTimer=null;setTimeout(function(){preloadAnimeTimer=setTimeout(function(){for(var i=0;i<strings.length;++i){strings[i].style.cssText="transition-delay:0s; transition:none;"}preloadAnime=anime.timeline({loop:true}).add({targets:strings,d:(el,i)=>{k=i*40+130;t=i*40+40;return"M 0 "+k+" Q 300 "+(k+t)+" 600 "+k},easing:"easeOutExpo",duration:1e3,delay:200}).add({targets:strings,d:(el,i)=>{k=i*40+130;return"M 0 "+k+" Q 300 "+k+" 600 "+k},easing:"easeOutElastic(3, .2)",duration:1500})},600);M99.load(target.url,function(data){window.scrollTo(0,0);M99.destroy();clearTimeout(preloadAnimeTimer);var html=document.createElement("html");html.innerHTML=data;var page=html.querySelector("main#content");let new_body=html.querySelector("body");let new_title=html.querySelector("title").innerText;body.setAttribute("class",new_body.getAttribute("class")+" preload-on");document.title=new_title;container.innerHTML='<main id="content">'+page.innerHTML+"</main>";if(target.push!=false){historyState.page_id++;history.pushState(historyState,new_title,target.url);let __path=target.url.split(document.domain)[1].slice(1);dispatchGTagEvent("page",{page_path:__path,page_title:new_title})}for(var i=0;i<strings.length;++i){strings[i].style.cssText=""}if(preloadAnime){preloadAnime.pause();preloadAnime.reset()}setTimeout(function(){body.classList.add("preload-off")},111);setTimeout(function(){body.classList.remove("preload-on");body.classList.remove("preload-off");M99.resize();M99.activate(container);M99.initSectionFocus(0)},1e3)},function(error){body.classList.remove("preload-on");body.classList.remove("preload-off");console.log(error)})},100)},load:function(url,success,error){var xhr=new XMLHttpRequest;xhr.al;xhr.onreadystatechange=function(){if(xhr.readyState===XMLHttpRequest.DONE){if(xhr.status===200){if(success)success(xhr.responseText)}else{if(error)error(xhr)}}};xhr.open("GET",url,true);xhr.send()},expandFooter:function(){body.classList.add("footer-expanded")},pause:function(){paused=true;for(i in LoopObjects)if(LoopObjects[i].instance==true)LoopObjects[i].pause()},play:function(){paused=false;for(i in LoopObjects)if(LoopObjects[i].instance==true)LoopObjects[i].play()},destroy:function(){if(instance)Effect.destroy();for(i in LoopObjects)if(LoopObjects[i].instance==true)LoopObjects[i].destroy()}};function openMenu(type){M99.pause();body.classList.add(type+"-open");logo.classList.remove("on");setTimeout(function(){logo.classList.add("on")},1e3);menuBackgroundAnim.setAttribute("to",_to);menuBackgroundAnim.setAttribute("from",_from);setTimeout(function(){menuBackgroundAnim.beginElement()},555)}function closeMenu(type){body.classList.remove(type+"-open");logo.classList.remove("on");setTimeout(function(){logo.classList.add("on");M99.play()},1e3);menuBackgroundAnim.setAttribute("to",_from);menuBackgroundAnim.setAttribute("from",_to);menuBackgroundAnim.beginElement()}function loadJS(array,callback){let t=this;let loaded=0;let total=array.length;t.load=function(url){var script=document.createElement("script");script.onload=function(){loaded++;if(loaded==total){if(callback)callback()}else{t.load(array[loaded])}};script.src=url;document.head.appendChild(script)};t.load(array[loaded])}function dispatchGTagEvent(type,obj){switch(type){case"page":{gtag("config","UA-4302615-9",obj)}break;case"event":{gtag("event",obj.event,obj.params)}}}window.mobile=function(){let check=false;(function(a){if(window.innerWidth<1e3||/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))check=true})(navigator.userAgent||navigator.vendor||window.opera);return check};if("serviceWorker"in navigator){window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js").then(function(registration){},function(err){})})}let initTimer=null;window.addEventListener("load",function(){initTimer=setInterval(function(){if(THREE!=undefined&&anime!=undefined){clearInterval(initTimer);M99.init()}},33)});
